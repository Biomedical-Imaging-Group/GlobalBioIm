<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Speedup with GPU &mdash; GlobalBioIm Library 1.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contact" href="contact.html" />
    <link rel="prev" title="List of Properties" href="propertiessummary.html" /> 
</head>

<body class="wy-body-for-nav" style="text-align:justify"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GlobalBioIm Library
          </a>
              <div class="version">
                1.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Biomedical-Imaging-Group/GlobalBioIm">Download or Clone (v 1.2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="infos.html">Important Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">Graphical User Interface (GUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="relatedPapers.html">Related Papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditionsuse.html">Conditions of Use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Abstract Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="linop.html">Linear Operators (LinOp)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nonlinop.html">Non-Linear Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="cost.html">Cost Functions (Cost)</a></li>
<li class="toctree-l1"><a class="reference internal" href="opti.html">Optimization Algorithms (Opti)</a></li>
<li class="toctree-l1"><a class="reference internal" href="methodssummary.html">List of Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="propertiessummary.html">List of Properties</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Speedup with GPU</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#main-functions">Main functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-which-generate-data">Functions which generate data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#concrete-example">Concrete example</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="http://bigwww.epfl.ch">Biomedical Imaging Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GlobalBioIm Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Speedup with GPU</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/gpu.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="speedup-with-gpu">
<span id="ref-gpu"></span><h1>Speedup with GPU<a class="headerlink" href="#speedup-with-gpu" title="Permalink to this heading"></a></h1>
<section id="main-functions">
<h2>Main functions<a class="headerlink" href="#main-functions" title="Permalink to this heading"></a></h2>
<p>Any script implemented using the library can be easily switched to GPU computation.
To that end, one only needs two simple functions:</p>
<blockquote>
<div><ul class="simple">
<li><p>useGPU</p></li>
<li><p>gpuCpuConverter</p></li>
</ul>
</div></blockquote>
<p>The function <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">useGPU()</span></code> takes one single argument which can be</p>
<blockquote>
<div><ul class="simple">
<li><p>0 : computation is done on CPU (default)</p></li>
<li><p>1 : computation is done on GPU using the <a class="reference external" href="https://ch.mathworks.com/help/distcomp/">Matlab Parrallel Computing Toolbox</a></p></li>
<li><p>2 : computation is done on GPU using CudaMat (<a class="reference external" href="https://github.com/RainerHeintzmann/CudaMat">GitHub</a>, <a class="reference external" href="http://www.nanoimaging.de/CudaMat/">Documentation</a>)</p></li>
</ul>
</div></blockquote>
<p>The function <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">gpuCpuConverter()</span></code> allows to convert numeric variables to the correct type according to the option selected with
<code class="xref mat mat-meth docutils literal notranslate"><span class="pre">useGPU()</span></code> (respectively, double, gpuarray or cuda). For instance, if x is a <code class="xref mat mat-class docutils literal notranslate"><span class="pre">double</span></code> and <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">useGPU</span></code> is set to 0, then <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">x=gpuCpuConverter(x)</span></code> will not change x.
But if x is a <code class="xref mat mat-class docutils literal notranslate"><span class="pre">double</span></code> and <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">useGPU</span></code> is set to 1, then <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">x=gpuCpuConverter(x)</span></code> will convert x to a <code class="xref mat mat-class docutils literal notranslate"><span class="pre">gpuarray</span></code>
(and send it to the graphic card). Hence, for each created/loaded variable “x” which is sufficiently large
(i.e. not for small vectors), one has to add the following line to the script</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">=</span><span class="n">gpuCpuConverter</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Then, the switch between CPU and GPU computation is simply controlled by <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">useGPU()</span></code> which can be placed at the beginning of the script.</p>
</section>
<section id="functions-which-generate-data">
<h2>Functions which generate data<a class="headerlink" href="#functions-which-generate-data" title="Permalink to this heading"></a></h2>
<p>Matlab functions such as <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">ones()</span></code> and <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">zeros()</span></code> require a memory allocation. When GPU is activated, it is faster to generate directly
these data on the graphic card instead of allocating CPU memory and then transfering them to the GPU. In order to make things transparents and
keep the code clear, all the occurences of <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">ones()</span></code> and <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">zeros()</span></code> (i.e. within scripts but also within library classes) should be replaced by
<code class="xref mat mat-meth docutils literal notranslate"><span class="pre">ones_()</span></code> and <code class="xref mat mat-meth docutils literal notranslate"><span class="pre">zeros_()</span></code>. These two functions have been defined in order to allocate the memory on the CPU or directly on the GPU according to the state of <code class="xref mat mat-attr docutils literal notranslate"><span class="pre">useGPU</span></code>.</p>
</section>
<section id="concrete-example">
<h2>Concrete example<a class="headerlink" href="#concrete-example" title="Permalink to this heading"></a></h2>
<p>The 3D deconvolution example provided in the “Example/” folder of the library shows a concrete use of the GPU functionality.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="propertiessummary.html" class="btn btn-neutral float-left" title="List of Properties" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contact.html" class="btn btn-neutral float-right" title="Contact" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Biomedical Imaging Group (EPFL).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>